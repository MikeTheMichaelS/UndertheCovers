
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>14. SLS Lecture 14 : Assembly using the OS &#8212; UndertheCovers</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="15. SLS Lecture 15 : Processes and Virtual Memory" href="L15.html" />
    <link rel="prev" title="13. SLS Lecture 13 : Program Anatomy V: The Tree of Bytes and Data Structures" href="L13.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">UndertheCovers</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro_ln.html">
                    Under the Covers : The Secret Life of Software
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Course Specfic Introductions
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../L00_210_JA.html">
   CS210 Computer Systems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../L00_400_F21_JA.html">
   CS400 Fall 2021 : Machine Level Programming
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Viewing Lectures
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../lnhowto.html">
   How to “view” lecture notes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../howto.html">
   How to read this book
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  The Unix Development Environment
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../unix/L01.html">
   1. SLS: Part I - UNIX : Introduction &amp;  Preliminaries
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../unix/L02.html">
   2. SLS Lecture 2 : Shell Part II : Programming, Files and Directories
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../unix/L03.html">
   3. UNIX Process, I/O and Credentials
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../unix/L04.html">
   4. SLS Lecture 4 : Editors, Make and Terminal IDEs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../unix/L05.html">
   5. SLS Lecture 5a : Version Control and GIT: Part I”
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../unix/L06.html">
   6. SLS Lecture 5b : Version Control and GIT: Part II”
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  The Belly of the Beast: The von Neumann Architecture and Assembly Programming
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="L07.html">
   7. SLS Lecture 7 : Assembly Programming Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="L08.html">
   8. SLS Lecture 8 :  Writing some simple assembly programs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="L09.html">
   9. UC-SLS Lecture 9 : Assembly : Operations and Data Types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="L10.html">
   10. SLS Lecture 10 : Assembly : Program Anatomy I
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="L11.html">
   11. SLS Lecture 11 :  Program Anatomy II : Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="L12.html">
   12. SLS Lecture 12 : Program Anatomy III : Code as Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="L13.html">
   13. SLS Lecture 13 : Program Anatomy V: The Tree of Bytes and Data Structures
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   14. SLS Lecture 14 : Assembly using the OS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="L15.html">
   15. SLS Lecture 15 : Processes and Virtual Memory
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="L16.html">
   16. SLS Lecture 16 : Topics
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Into the Light : C Programming
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../C/L17.html">
   17. UC-SLS Lecuture 17 : In to the Light - C Intro
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../C/L18.html">
   18. UC-SLS Lecture 18 : Using C to write and organize opcode bytes - Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../C/L19.html">
   19. UC-SLS Lecture 19 : Using C to map and organize our data bytes - Data Types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../C/L20.html">
   20. UC-SLS Lecture 20 : Using LibC to access the OS and escape the confines our process
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../C/L21.html">
   21. UC-SLS Lecture 21 : The rest of LibC and other libraries
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../C/L22.html">
   22. SLS Lecture 22 : Topics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../C/L23.html">
   23. SLS Lecture 23 : Topics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../C/L24.html">
   24. SLS Lecture 24 : Topics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../C/L25.html">
   25. SLS Lecture 25 : Topics
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<a href="https://github.com/jappavoo/UndertheCovers"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="bottom"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/assembly/L14.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#review-of-processes">
   14.1. Review of Processes
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#processes-and-the-kernel">
     14.1.1. Processes and the Kernel
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#review-of-system-calls-from-lecture-08">
   14.2. Review of System Calls - From Lecture 08
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#intel-syscall">
     14.2.1. Intel
     <code class="docutils literal notranslate">
      <span class="pre">
       syscall
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-os-system-calls">
     14.2.2. The OS System Calls
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#linux-system-calls">
     14.2.3. LINUX SYSTEM CALLS
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#process-address-spaces">
   14.3. Process Address Spaces
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#address-space-organizes-memory-of-a-process">
     14.3.1. Address Space organizes Memory of a Process
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#assembly-programming-as-process-address-space-image-creation">
     14.3.2. Assembly Programming as Process Address Space Image creation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-details">
     14.3.3. The Details
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#process-address-space">
     14.3.4. Process Address Space
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exploring-the-address-space">
     14.3.5. Exploring the Address Space
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#add-another-section-to-control-how-region-is-mapped">
       14.3.5.1. Add another section to control how region is mapped
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ok-lets-get-some-more-memory-and-and-grow-our-heap">
   14.4. Ok lets get some more memory – And and Grow our Heap
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#i-o">
   14.5. I/O
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#review-from-lecture-3">
     14.5.1. Review from Lecture 3
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finally-hello-world-in-assembly">
     14.5.2. Finally “Hello World in Assembly”
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#at-long-last-we-have-a-program-that-we-don-t-need-the-debugger-for">
       14.5.2.1. At long last we have a program that we don’t need the debugger for!
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#there-are-many-more-calls-for-doing-i-o">
     14.5.3. There are many more calls for doing I/O
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercises">
     14.5.4. Exercises
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>SLS Lecture 14 : Assembly using the OS</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#review-of-processes">
   14.1. Review of Processes
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#processes-and-the-kernel">
     14.1.1. Processes and the Kernel
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#review-of-system-calls-from-lecture-08">
   14.2. Review of System Calls - From Lecture 08
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#intel-syscall">
     14.2.1. Intel
     <code class="docutils literal notranslate">
      <span class="pre">
       syscall
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-os-system-calls">
     14.2.2. The OS System Calls
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#linux-system-calls">
     14.2.3. LINUX SYSTEM CALLS
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#process-address-spaces">
   14.3. Process Address Spaces
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#address-space-organizes-memory-of-a-process">
     14.3.1. Address Space organizes Memory of a Process
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#assembly-programming-as-process-address-space-image-creation">
     14.3.2. Assembly Programming as Process Address Space Image creation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-details">
     14.3.3. The Details
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#process-address-space">
     14.3.4. Process Address Space
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exploring-the-address-space">
     14.3.5. Exploring the Address Space
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#add-another-section-to-control-how-region-is-mapped">
       14.3.5.1. Add another section to control how region is mapped
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ok-lets-get-some-more-memory-and-and-grow-our-heap">
   14.4. Ok lets get some more memory – And and Grow our Heap
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#i-o">
   14.5. I/O
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#review-from-lecture-3">
     14.5.1. Review from Lecture 3
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finally-hello-world-in-assembly">
     14.5.2. Finally “Hello World in Assembly”
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#at-long-last-we-have-a-program-that-we-don-t-need-the-debugger-for">
       14.5.2.1. At long last we have a program that we don’t need the debugger for!
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#there-are-many-more-calls-for-doing-i-o">
     14.5.3. There are many more calls for doing I/O
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercises">
     14.5.4. Exercises
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="sls-lecture-14-assembly-using-the-os">
<h1><span class="section-number">14. </span>SLS Lecture 14 : Assembly using the OS<a class="headerlink" href="#sls-lecture-14-assembly-using-the-os" title="Permalink to this headline">#</a></h1>
<ul class="simple">
<li><p>Review of Processes</p></li>
<li><p>Review of Systems Calls</p></li>
<li><p>Process Address Spaces</p>
<ul>
<li><p>Dynamic Memory : Adding and Growing our heap</p></li>
</ul>
</li>
<li><p>I/O - Assembly “Hello World”</p></li>
</ul>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<ul class="simple">
<li><p>create a directory <code class="docutils literal notranslate"><span class="pre">mkdir</span> <span class="pre">syscalls;</span> <span class="pre">cd</span> <span class="pre">syscalls</span></code></p></li>
<li><p>copy examples</p></li>
<li><p>add a <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> to automate assembling and linking</p>
<ul>
<li><p>we are going run the commands by hand this time to highlight the details</p></li>
</ul>
</li>
<li><p>add our <code class="docutils literal notranslate"><span class="pre">setup.gdb</span></code> to make working in gdb easier</p></li>
<li><p>normally you would want to track everything in git</p></li>
</ul>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "ee7250f240274126b3cf6af2683fbe54", "version_major": 2, "version_minor": 0}
</script></div>
</div>
<section id="review-of-processes">
<h2><span class="section-number">14.1. </span>Review of Processes<a class="headerlink" href="#review-of-processes" title="Permalink to this headline">#</a></h2>
<section id="processes-and-the-kernel">
<h3><span class="section-number">14.1.1. </span>Processes and the Kernel<a class="headerlink" href="#processes-and-the-kernel" title="Permalink to this headline">#</a></h3>
<center>
<img src="../images/UnixRunning.png">
    </center><center>
    <img src="../images/Processes/Processes.004.png">
</center><center>
    <img src="../images/Processes/Processes.005.png">
</center></section>
</section>
<section id="review-of-system-calls-from-lecture-08">
<h2><span class="section-number">14.2. </span>Review of System Calls - From Lecture 08<a class="headerlink" href="#review-of-system-calls-from-lecture-08" title="Permalink to this headline">#</a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<!-- produced by: 
htmlFig("[{'src': '../images/kerneldef.png'}]", 
        id="", 
        align="center", 
        width="100%",
        margin="auto auto auto auto",
        caption="", 
        captionalign="left")
-->
<table align="center" width="100%" cellpadding="0" cellspacing="0" border="0" style="border-collapse: collapse; margin: auto auto auto auto">
    <tr style="padding: 0; margin: 0;"> 
        <td colspan="1" width="100%" style="padding: 0; margin: 0 0 0 0; background-color:inherit;">
            <div style="padding: 0; margin: 0 0 0 0;">
              <figure style="padding: 0; margin: 0 0 0 0; width:100%;">
                   <img src="../images/kerneldef.png" width="100%" style="padding: 0; margin: 0;">
                </figure>
            </div>
        </td>
    </tr>
</table>
</div>
</div>
<p>Remember this…</p>
<p><strong>The “Kernel” – Unique to Every OS</strong></p>
<ol class="simple">
<li><p>Bootstraps the HW and has direct access to all of it</p></li>
<li><p>Bottom layer that enables other programs to run</p></li>
<li><p><font style="color:red;"> <strong>A unique collection of functions that programs can invoke</strong> </font></p></li>
</ol>
<p>Not useful on its own only useful and accessed by running other programs.</p>
<center>
<img src="../images/Processes/Processes.051.png">
</center><section id="intel-syscall">
<h3><span class="section-number">14.2.1. </span>Intel <code class="docutils literal notranslate"><span class="pre">syscall</span></code><a class="headerlink" href="#intel-syscall" title="Permalink to this headline">#</a></h3>
<p>On Intel the instruction is <code class="docutils literal notranslate"><span class="pre">syscall</span></code></p>
<img alt="../_images/syscallmp.png" src="../_images/syscallmp.png" />
</section>
<section id="the-os-system-calls">
<h3><span class="section-number">14.2.2. </span>The OS System Calls<a class="headerlink" href="#the-os-system-calls" title="Permalink to this headline">#</a></h3>
<p>Each OS Kernel provides a set of calls that a process can invoke using the <code class="docutils literal notranslate"><span class="pre">syscall</span></code> instruction on an Intel based computer</p>
<p>The Linux Kernel supports a very large number of system calls each is identified by a unique number that must be placed in <code class="docutils literal notranslate"><span class="pre">RAX</span></code> prior to executing the <code class="docutils literal notranslate"><span class="pre">syscall</span></code> instruction.  Additional arguments are passed in by setting other registers.</p>
<p>With each version of the Kernel the table of calls changes.  Here is one site that provides a list</p>
</section>
<section id="linux-system-calls">
<h3><span class="section-number">14.2.3. </span>LINUX SYSTEM CALLS<a class="headerlink" href="#linux-system-calls" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>reading some man pages <code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">syscalls</span></code> and <code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">syscall</span></code> we find that</p>
<ul>
<li><p>to exit we must place <code class="docutils literal notranslate"><span class="pre">60</span></code> in <code class="docutils literal notranslate"><span class="pre">rax</span></code></p></li>
<li><p>and that the value we want to set as our exit status code in <code class="docutils literal notranslate"><span class="pre">rdi</span></code></p></li>
</ul>
</li>
<li><p>each system call will accept arguments in various registers</p></li>
<li><p>NOTE: <strong>On INTEL 64bit processors <code class="docutils literal notranslate"><span class="pre">rcx</span></code> will be overwritten by the syscall instruction</strong></p></li>
<li><p>On INTEL 64bit processors Linux system calls will return a value back in <code class="docutils literal notranslate"><span class="pre">rax</span></code> and possibly <code class="docutils literal notranslate"><span class="pre">rdx</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">rax</span></code> and possibly <code class="docutils literal notranslate"><span class="pre">rdx</span></code> will be overwritten by a system call</p></li>
</ul>
</li>
</ul>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "796e616035d04bf0bd4a1f42d928f133", "version_major": 2, "version_minor": 0}
</script></div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html">
<iframe
    width="100%"
    height="600"
    src="https://filippo.io/linux-syscall-table/"
    frameborder="0"
    allowfullscreen

></iframe>
</div></div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div style="width:100%; height:100%; font-size:inherit; overflow: auto;" >
<div class="highlight-gas notranslate"><div class="highlight"><pre><span></span><span class="w">	</span><span class="na">.intel_syntax</span><span class="w"> </span><span class="no">noprefix</span><span class="w"></span>
<span class="w">	</span>
<span class="w">	</span><span class="na">.text</span><span class="w"></span>
<span class="w">	</span><span class="na">.global</span><span class="w"> </span><span class="no">_start</span><span class="w"></span>
<span class="nl">_start:</span><span class="w">      	</span>
<span class="w">	</span><span class="nf">mov</span><span class="w">     </span><span class="no">rax</span><span class="p">,</span><span class="w"> </span><span class="mi">60</span><span class="w">    </span><span class="c1"># Linux exit system call number is 60       </span>
<span class="w">	</span><span class="nf">mov</span><span class="w">     </span><span class="no">rdi</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w">     </span><span class="c1"># rdi is return value 0 success</span>

<span class="w">	</span><span class="nf">syscall</span><span class="w">                         	</span>
</pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="process-address-spaces">
<h2><span class="section-number">14.3. </span>Process Address Spaces<a class="headerlink" href="#process-address-spaces" title="Permalink to this headline">#</a></h2>
<section id="address-space-organizes-memory-of-a-process">
<h3><span class="section-number">14.3.1. </span>Address Space organizes Memory of a Process<a class="headerlink" href="#address-space-organizes-memory-of-a-process" title="Permalink to this headline">#</a></h3>
<center>
    <img src="../images/ProcessContexts.png">
</center><p><strong>Remember</strong></p>
<ol class="simple">
<li><p>The binaries we create using the assembler and linker are Executables</p></li>
<li><p>When we “run” our executables via the shell it creates a new process context and our binary is loaded as the initial memory “image”.</p></li>
<li><p>The memory and register values of the process are unique to each process and change as the instructions of our binary “execute”</p></li>
</ol>
</section>
<section id="assembly-programming-as-process-address-space-image-creation">
<h3><span class="section-number">14.3.2. </span>Assembly Programming as Process Address Space Image creation<a class="headerlink" href="#assembly-programming-as-process-address-space-image-creation" title="Permalink to this headline">#</a></h3>
<center>
    <img src="../images/ASSEMBLY-AddressSpaceandIO/ASSEMBLY-AddressSpaceandIO.003.png">
</center><center>
    <img src="../images/ASSEMBLY-AddressSpaceandIO/ASSEMBLY-AddressSpaceandIO.004.png">
</center><center>
    <img src="../images/ASSEMBLY-AddressSpaceandIO/ASSEMBLY-AddressSpaceandIO.005.png">
</center></section>
<section id="the-details">
<h3><span class="section-number">14.3.3. </span>The Details<a class="headerlink" href="#the-details" title="Permalink to this headline">#</a></h3>
</section>
<section id="process-address-space">
<h3><span class="section-number">14.3.4. </span>Process Address Space<a class="headerlink" href="#process-address-space" title="Permalink to this headline">#</a></h3>
<p>The Memory of a Process is organized as an (Virtual) Address Space</p>
<ol class="simple">
<li><p>Each possible location of a byte is identified by a unique address (number)</p></li>
<li><p>To associate a Region (range of continues addresses) with actual memory requires a “mapping”</p>
<ul class="simple">
<li><p>mappings associate a Region with Memory and a possible source of values</p></li>
<li><p>mappings can restrict what kind of access can be made to region</p>
<ol class="simple">
<li><p>fetch for execute: x</p></li>
<li><p>read: r</p></li>
<li><p>write: w</p></li>
</ol>
</li>
</ul>
</li>
</ol>
<center>
    <img src="../images/ExecAddrSpace/ExecAddrSpace-001.png">
</center><center>
    <img src="../images/ExecAddrSpace/ExecAddrSpace-002.png">
</center><center>
    <img src="../images/ExecAddrSpace/ExecAddrSpace-003.png">
</center><center>
    <img src="../images/ExecAddrSpace/ExecAddrSpace-004.png">
</center><center>
    <img src="../images/ExecAddrSpace/ExecAddrSpace-005.png">
</center><center>
    <img src="../images/ExecAddrSpace/ExecAddrSpace-006.png">
</center><center>
    <img src="../images/ExecAddrSpace/ExecAddrSpace-007.png">
</center><center>
    <img src="../images/ExecAddrSpace/ExecAddrSpace-008.png">
</center><center>
    <img src="../images/ExecAddrSpace/ExecAddrSpace-009.png">
</center><center>
    <img src="../images/ExecAddrSpace/ExecAddrSpace-010.png">
</center><center>
    <img src="../images/ExecAddrSpace/ExecAddrSpace-011.png">
</center></section>
<section id="exploring-the-address-space">
<h3><span class="section-number">14.3.5. </span>Exploring the Address Space<a class="headerlink" href="#exploring-the-address-space" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Let’s explore the address space of a running program</p></li>
</ul>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<p><b>CODE: asm - usesum5.s</p>
<div style="width:107em; height:100%; font-size:inherit; overflow: auto;" >
<div class="highlight-gas notranslate"><div class="highlight"><pre><span></span><span class="w">	</span><span class="na">.intel_syntax</span><span class="w"> </span><span class="no">noprefix</span><span class="w"></span>
<span class="w">	</span><span class="na">.data</span><span class="w">	</span>
<span class="w">	</span><span class="no">.comm</span><span class="w"> </span><span class="no">A_SUM</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="w"></span>
<span class="w">	</span><span class="na">.comm</span><span class="w"> </span><span class="no">A_LEN</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="w"></span>
<span class="w">	</span><span class="na">.comm</span><span class="w"> </span><span class="no">A</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">*</span><span class="mi">1024</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="w">	</span>

<span class="w">	</span><span class="no">.comm</span><span class="w"> </span><span class="no">B_SUM</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="w"></span>
<span class="w">	</span><span class="na">.comm</span><span class="w"> </span><span class="no">B_LEN</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="w"></span>
<span class="w">	</span><span class="na">.comm</span><span class="w"> </span><span class="no">B</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">*</span><span class="mi">1024</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="w">	</span>

<span class="w">	</span><span class="no">.comm</span><span class="w"> </span><span class="no">C_SUM</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="w"></span>
<span class="w">	</span><span class="na">.comm</span><span class="w"> </span><span class="no">C_LEN</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="w"></span>
<span class="w">	</span><span class="na">.comm</span><span class="w"> </span><span class="no">C</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">*</span><span class="mi">1024</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="w">	</span>

<span class="w">	</span><span class="no">.text</span><span class="w"></span>
<span class="w">	</span><span class="na">.global</span><span class="w"> </span><span class="no">_start</span><span class="w"> </span>
<span class="no">_start</span><span class="p">:</span><span class="w"></span>
<span class="w">	</span><span class="nf">mov</span><span class="w"> </span><span class="no">rbx</span><span class="p">,</span><span class="w"> </span><span class="no">QWORD</span><span class="w"> </span><span class="no">PTR</span><span class="w"> </span><span class="p">[</span><span class="no">A_LEN</span><span class="p">]</span><span class="w"></span>
<span class="w">	</span><span class="nf">mov</span><span class="w"> </span><span class="no">rcx</span><span class="p">,</span><span class="w"> </span><span class="no">OFFSET</span><span class="w"> </span><span class="no">A</span><span class="w"></span>
<span class="w">	</span><span class="nf">call</span><span class="w"> </span><span class="no">sumIt</span><span class="w"></span>
<span class="w">	</span><span class="nf">mov</span><span class="w"> </span><span class="no">QWORD</span><span class="w"> </span><span class="no">PTR</span><span class="w"> </span><span class="p">[</span><span class="no">A_SUM</span><span class="p">],</span><span class="w"> </span><span class="no">rax</span><span class="w"></span>

<span class="w">	</span><span class="nf">mov</span><span class="w"> </span><span class="no">rbx</span><span class="p">,</span><span class="w"> </span><span class="no">QWORD</span><span class="w"> </span><span class="no">PTR</span><span class="w"> </span><span class="p">[</span><span class="no">B_LEN</span><span class="p">]</span><span class="w"></span>
<span class="w">	</span><span class="nf">mov</span><span class="w"> </span><span class="no">rcx</span><span class="p">,</span><span class="w"> </span><span class="no">OFFSET</span><span class="w"> </span><span class="no">B</span><span class="w"></span>
<span class="w">	</span><span class="nf">call</span><span class="w"> </span><span class="no">sumIt</span><span class="w"></span>
<span class="w">	</span><span class="nf">mov</span><span class="w"> </span><span class="no">QWORD</span><span class="w"> </span><span class="no">PTR</span><span class="w"> </span><span class="p">[</span><span class="no">B_SUM</span><span class="p">],</span><span class="w"> </span><span class="no">rax</span><span class="w"></span>

<span class="w">	</span><span class="nf">mov</span><span class="w"> </span><span class="no">rbx</span><span class="p">,</span><span class="w"> </span><span class="no">QWORD</span><span class="w"> </span><span class="no">PTR</span><span class="w"> </span><span class="p">[</span><span class="no">C_LEN</span><span class="p">]</span><span class="w"></span>
<span class="w">	</span><span class="nf">mov</span><span class="w"> </span><span class="no">rcx</span><span class="p">,</span><span class="w"> </span><span class="no">OFFSET</span><span class="w"> </span><span class="no">C</span><span class="w"></span>
<span class="w">	</span><span class="nf">call</span><span class="w"> </span><span class="no">sumIt</span><span class="w"></span>
<span class="w">	</span><span class="nf">mov</span><span class="w"> </span><span class="no">QWORD</span><span class="w"> </span><span class="no">PTR</span><span class="w"> </span><span class="p">[</span><span class="no">C_SUM</span><span class="p">],</span><span class="w"> </span><span class="no">rax</span><span class="w"></span>
<span class="w">	</span><span class="nf">int3</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<p><b>CODE: asm - sumit6.s</p>
<div style="width:107em; height:100%; font-size:inherit; overflow: auto;" >
<div class="highlight-gas notranslate"><div class="highlight"><pre><span></span>	.intel_syntax noprefix
	
	.global sumIt	      	      #	 directive to let the linker

	# code to sum data in array who&#39;s address is in rcx
	# we assume we were started with call so return address on stack
	# we assume rbx has length  rbx -&gt; len
	# and that we will leave final sum in rax
sumIt:	                              # location of this code is
	xor  rax, rax            # rax -&gt; sum : sum = 0
	push rdi                 # spill current value of rdi before we use
	xor  rdi, rdi            # rax -&gt; i : i = 0

	# code to sum data at value in rcx
	# we assume rbx has length  rbx -&gt; len
	# and that we will leave final sum in rax
loop_start:
	cmp  rbx, rdi
	jz   loop_done
	add  rax, QWORD PTR [rcx + rdi * 8] # add the i&#39;th value to the sum
	inc  rdi                   # i=i+1
	jmp   loop_start
loop_done:
	pop  rdi                 # restore rdi back to its original value
	ret


</pre></div>
</div>
</div>
</div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "dd5e3c4bae194857a88d0206d43b7929", "version_major": 2, "version_minor": 0}
</script></div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<p><b>Debug</b></p>
</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="n">_start</span>
<span class="n">run</span> 
<span class="n">info</span> <span class="n">proc</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">cat</span> <span class="o">/</span><span class="n">proc</span><span class="o">/&lt;</span><span class="n">pid</span><span class="o">&gt;/</span><span class="n">maps</span>
</pre></div>
</div>
<p>Use gdb to explore what’s there and compare with binary binary file</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "e5a2de6ee9d54e5d9f487acc2f174706", "version_major": 2, "version_minor": 0}
</script></div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "ecc478b04bfb4400b8683f8276f0bc91", "version_major": 2, "version_minor": 0}
</script></div>
</div>
<section id="add-another-section-to-control-how-region-is-mapped">
<h4><span class="section-number">14.3.5.1. </span>Add another section to control how region is mapped<a class="headerlink" href="#add-another-section-to-control-how-region-is-mapped" title="Permalink to this headline">#</a></h4>
<p>Read-only data section <code class="docutils literal notranslate"><span class="pre">.rodata</span></code></p>
<div class="highlight-nasm notranslate"><div class="highlight"><pre><span></span><span class="w">         </span><span class="nf">.section</span><span class="w"> </span><span class="nv">.rodata</span><span class="w"></span>

<span class="w"> </span><span class="nl">str1:</span><span class="w"></span>
<span class="w">         </span><span class="nf">.string</span><span class="w"> </span><span class="s">&quot;Hello World\n&quot;</span><span class="w"></span>
</pre></div>
</div>
<p>What would happen if we put all our data in the <code class="docutils literal notranslate"><span class="pre">.rodata</span></code> section… try it and find out</p>
</section>
</section>
</section>
<section id="ok-lets-get-some-more-memory-and-and-grow-our-heap">
<h2><span class="section-number">14.4. </span>Ok lets get some more memory – And and Grow our Heap<a class="headerlink" href="#ok-lets-get-some-more-memory-and-and-grow-our-heap" title="Permalink to this headline">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">brk</span></code> system call</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "0046d9f05a654785afa777d63e549605", "version_major": 2, "version_minor": 0}
</script></div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html">
<iframe
    width="100%"
    height="600"
    src="https://filippo.io/linux-syscall-table/"
    frameborder="0"
    allowfullscreen

></iframe>
</div></div>
</div>
<p><strong>Lets add this code</strong></p>
<p>What does it do?</p>
<div class="highlight-gas notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="na">.data</span><span class="w"></span>
<span class="nl">NEW_MEM_PTR:</span><span class="w"></span>
<span class="w">    </span><span class="na">.quad</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>

<span class="w">    </span><span class="na">.text</span><span class="w"></span>
<span class="w">    </span>
<span class="w">    </span><span class="nf">mov</span><span class="w"> </span><span class="no">rdi</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">    </span><span class="nf">mov</span><span class="w"> </span><span class="no">rax</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="w"></span>
<span class="w">    </span><span class="nf">syscall</span><span class="w"> </span>
<span class="w">    </span><span class="no">mov</span><span class="w"> </span><span class="no">QWORD</span><span class="w"> </span><span class="no">PTR</span><span class="w"> </span><span class="p">[</span><span class="no">NEW_MEM_PTR</span><span class="p">],</span><span class="w"> </span><span class="no">rax</span><span class="w"></span>
<span class="w">    </span>
<span class="w">    </span><span class="nf">mov</span><span class="w"> </span><span class="no">rdi</span><span class="p">,</span><span class="w"> </span><span class="no">rax</span><span class="w"></span>
<span class="w">    </span><span class="nf">add</span><span class="w"> </span><span class="no">rdi</span><span class="p">,</span><span class="w"> </span><span class="mi">1024</span><span class="w"> </span><span class="p">*</span><span class="w"> </span><span class="mi">8</span><span class="w"></span>
<span class="w">    </span><span class="nf">mov</span><span class="w"> </span><span class="no">rax</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="w"></span>
<span class="w">    </span><span class="nf">syscall</span><span class="w"></span>
</pre></div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<p><b>CODE: asm - usesumheap.s</p>
<div style="width:107em; height:100%; font-size:inherit; overflow: auto;" >
<div class="highlight-gas notranslate"><div class="highlight"><pre><span></span><span class="w">	</span><span class="na">.intel_syntax</span><span class="w"> </span><span class="no">noprefix</span><span class="w"></span>
<span class="w">	</span><span class="na">.section</span><span class="w"> </span><span class="no">.data</span><span class="w">	</span>
<span class="w">	</span><span class="no">.comm</span><span class="w"> </span><span class="no">A_SUM</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="w"></span>
<span class="w">	</span><span class="na">.comm</span><span class="w"> </span><span class="no">A_LEN</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="w"></span>
<span class="w">	</span><span class="na">.comm</span><span class="w"> </span><span class="no">A</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">*</span><span class="mi">1024</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="w">	</span>

<span class="w">	</span><span class="no">.comm</span><span class="w"> </span><span class="no">B_SUM</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="w"></span>
<span class="w">	</span><span class="na">.comm</span><span class="w"> </span><span class="no">B_LEN</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="w"></span>
<span class="w">	</span><span class="na">.comm</span><span class="w"> </span><span class="no">B</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">*</span><span class="mi">1024</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="w">	</span>

<span class="w">	</span><span class="no">.comm</span><span class="w"> </span><span class="no">C_SUM</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="w"></span>
<span class="w">	</span><span class="na">.comm</span><span class="w"> </span><span class="no">C_LEN</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="w"></span>
<span class="w">	</span><span class="na">.comm</span><span class="w"> </span><span class="no">C</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">*</span><span class="mi">1024</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="w">	</span>

<span class="w">	</span><span class="c1"># Added space heap memory array</span>
<span class="w">	</span><span class="na">.comm</span><span class="w"> </span><span class="no">D_SUM</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="w"></span>
<span class="w">	</span><span class="na">.comm</span><span class="w"> </span><span class="no">D_LEN</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="w"></span>
<span class="w">	</span><span class="na">.comm</span><span class="w"> </span><span class="no">D_PTR</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="w"></span>

<span class="w">	</span><span class="na">.section</span><span class="w"> </span><span class="no">.rodata</span><span class="w"></span>
<span class="nl">mystr:</span><span class="w">	</span>
<span class="w">	</span><span class="na">.string</span><span class="w"> </span><span class="s">&quot;Hello World!!!\n&quot;</span><span class="w"></span>
<span class="w">	</span>
<span class="w">	</span><span class="na">.section</span><span class="w"> </span><span class="no">.text</span><span class="w"></span>
<span class="w">	</span><span class="na">.global</span><span class="w"> </span><span class="no">_start</span><span class="w"> </span>
<span class="no">_start</span><span class="p">:</span><span class="w"></span>
<span class="w">	</span><span class="c1"># get current break pointer</span>
<span class="w">	</span><span class="nf">mov</span><span class="w"> </span><span class="no">rdi</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w">                 </span><span class="c1"># pass 0 to brk (invalid request)</span>
<span class="w">	</span><span class="nf">mov</span><span class="w"> </span><span class="no">rax</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="w">                </span><span class="c1"># brk syscall number 12</span>
<span class="w">	</span><span class="nf">syscall</span><span class="w">                    </span><span class="c1"># call brk with 0</span>
<span class="w">	</span><span class="nf">mov</span><span class="w"> </span><span class="no">QWORD</span><span class="w"> </span><span class="no">PTR</span><span class="w"> </span><span class="p">[</span><span class="no">D_PTR</span><span class="p">],</span><span class="w"> </span><span class="no">rax</span><span class="w"> </span><span class="c1"># set D_PTR to start of end of break memory</span>
<span class="w">	</span><span class="nf">mov</span><span class="w"> </span><span class="no">rdi</span><span class="p">,</span><span class="w"> </span><span class="no">rax</span><span class="w">               </span><span class="c1"># mov current end of break into rax</span>
<span class="w">	</span>
<span class="w">	</span><span class="nf">add</span><span class="w"> </span><span class="no">rdi</span><span class="p">,</span><span class="w"> </span><span class="mi">1024</span><span class="w"> </span><span class="p">*</span><span class="w"> </span><span class="mi">8</span><span class="w">          </span><span class="c1"># add request num bytes to end break</span>
<span class="w">	</span><span class="nf">mov</span><span class="w"> </span><span class="no">rax</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="w">                </span><span class="c1"># brk syscall number 12</span>
<span class="w">	</span><span class="nf">syscall</span><span class="w">                    </span><span class="c1"># call brk with break end + request</span>

<span class="w">	</span><span class="nf">mov</span><span class="w"> </span><span class="no">rbx</span><span class="p">,</span><span class="w"> </span><span class="no">QWORD</span><span class="w"> </span><span class="no">PTR</span><span class="w"> </span><span class="p">[</span><span class="no">D_LEN</span><span class="p">]</span><span class="w"> </span>
<span class="w">	</span><span class="no">mov</span><span class="w"> </span><span class="no">rcx</span><span class="p">,</span><span class="w"> </span><span class="no">QWORD</span><span class="w"> </span><span class="no">PTR</span><span class="w"> </span><span class="p">[</span><span class="no">D_PTR</span><span class="p">]</span><span class="w"></span>
<span class="w">	</span><span class="nf">call</span><span class="w"> </span><span class="no">sumIt</span><span class="w"></span>
<span class="w">	</span><span class="nf">mov</span><span class="w"> </span><span class="no">QWORD</span><span class="w"> </span><span class="no">PTR</span><span class="w"> </span><span class="p">[</span><span class="no">D_SUM</span><span class="p">],</span><span class="w"> </span><span class="no">rax</span><span class="w"></span>

<span class="w">	</span><span class="nf">mov</span><span class="w"> </span><span class="no">rbx</span><span class="p">,</span><span class="w"> </span><span class="no">QWORD</span><span class="w"> </span><span class="no">PTR</span><span class="w"> </span><span class="p">[</span><span class="no">A_LEN</span><span class="p">]</span><span class="w"></span>
<span class="w">	</span><span class="nf">mov</span><span class="w"> </span><span class="no">rcx</span><span class="p">,</span><span class="w"> </span><span class="no">OFFSET</span><span class="w"> </span><span class="no">A</span><span class="w"></span>
<span class="w">	</span><span class="nf">call</span><span class="w"> </span><span class="no">sumIt</span><span class="w"></span>
<span class="w">	</span><span class="nf">mov</span><span class="w"> </span><span class="no">QWORD</span><span class="w"> </span><span class="no">PTR</span><span class="w"> </span><span class="p">[</span><span class="no">A_SUM</span><span class="p">],</span><span class="w"> </span><span class="no">rax</span><span class="w"></span>

<span class="w">	</span><span class="nf">mov</span><span class="w"> </span><span class="no">rbx</span><span class="p">,</span><span class="w"> </span><span class="no">QWORD</span><span class="w"> </span><span class="no">PTR</span><span class="w"> </span><span class="p">[</span><span class="no">B_LEN</span><span class="p">]</span><span class="w"></span>
<span class="w">	</span><span class="nf">mov</span><span class="w"> </span><span class="no">rcx</span><span class="p">,</span><span class="w"> </span><span class="no">OFFSET</span><span class="w"> </span><span class="no">B</span><span class="w"></span>
<span class="w">	</span><span class="nf">call</span><span class="w"> </span><span class="no">sumIt</span><span class="w"></span>
<span class="w">	</span><span class="nf">mov</span><span class="w"> </span><span class="no">QWORD</span><span class="w"> </span><span class="no">PTR</span><span class="w"> </span><span class="p">[</span><span class="no">B_SUM</span><span class="p">],</span><span class="w"> </span><span class="no">rax</span><span class="w"></span>

<span class="w">	</span><span class="nf">mov</span><span class="w"> </span><span class="no">rbx</span><span class="p">,</span><span class="w"> </span><span class="no">QWORD</span><span class="w"> </span><span class="no">PTR</span><span class="w"> </span><span class="p">[</span><span class="no">C_LEN</span><span class="p">]</span><span class="w"></span>
<span class="w">	</span><span class="nf">mov</span><span class="w"> </span><span class="no">rcx</span><span class="p">,</span><span class="w"> </span><span class="no">OFFSET</span><span class="w"> </span><span class="no">C</span><span class="w"></span>
<span class="w">	</span><span class="nf">call</span><span class="w"> </span><span class="no">sumIt</span><span class="w"></span>
<span class="w">	</span><span class="nf">mov</span><span class="w"> </span><span class="no">QWORD</span><span class="w"> </span><span class="no">PTR</span><span class="w"> </span><span class="p">[</span><span class="no">C_SUM</span><span class="p">],</span><span class="w"> </span><span class="no">rax</span><span class="w"></span>

<span class="w">	</span><span class="nf">mov</span><span class="w"> </span><span class="no">rdi</span><span class="p">,</span><span class="w"> </span><span class="no">rax</span><span class="w"></span>
<span class="w">	</span><span class="nf">mov</span><span class="w"> </span><span class="no">rax</span><span class="p">,</span><span class="w"> </span><span class="mi">60</span><span class="w"></span>
<span class="w">	</span><span class="nf">syscall</span><span class="w"></span>
<span class="w">	</span>
</pre></div>
</div>
</div>
</div>
</div>
<p><strong>What does the regions maps look like now?</strong></p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<p><b>usesumheap gdb</p>
<div style="width:107em; height:100%; font-size:inherit; overflow: auto;" >
<div class="highlight-gas notranslate"><div class="highlight"><pre><span></span>b _start
run
display /1gx &amp;D_PTR
x/10gd (void *)D_PTR
si
si
si
si
x/10gd (void *)D_PTR
si
si
si
si
x/10gd (void *)D_PTR
restore 100.bin binary &lt;addr&gt;
x/10gd (void *)D_PTR
set *((long long *)&amp;D_LEN)=100
disass
break *addr
c
si
display /1gd D_SUM



</pre></div>
</div>
</div>
</div>
</div>
<center>
    <img src="../images/ASSEMBLY-AddressSpaceandIO/ASSEMBLY-AddressSpaceandIO.012.png">
</center><center>
    <img src="../images/ASSEMBLY-AddressSpaceandIO/ASSEMBLY-AddressSpaceandIO.016.png">
</center></section>
<section id="i-o">
<h2><span class="section-number">14.5. </span>I/O<a class="headerlink" href="#i-o" title="Permalink to this headline">#</a></h2>
<center>
    <img src="../images/ASSEMBLY-AddressSpaceandIO/ASSEMBLY-AddressSpaceandIO.017.png">
</center><center>
    <img src="../images/ASSEMBLY-AddressSpaceandIO/ASSEMBLY-AddressSpaceandIO.018.png">
</center><section id="review-from-lecture-3">
<h3><span class="section-number">14.5.1. </span>Review from Lecture 3<a class="headerlink" href="#review-from-lecture-3" title="Permalink to this headline">#</a></h3>
<center>
    <img src="../images/Processes/Processes.006.png">
</center><center>
    <img src="../images/Processes/Processes.007.png">
</center><center>
    <img src="../images/Processes/Processes.008.png">
</center><center>
    <img src="../images/Processes/Processes.009.png">
</center><center>
    <img src="../images/Processes/Processes.010.png">
</center><center>
    <img src="../images/Processes/Processes.011.png">
</center><center>
    <img src="../images/Processes/Processes.012.png">
</center><center>
    <img src="../images/Processes/Processes.013.png">
</center><center>
    <img src="../images/Processes/Processes.015.png">
</center></section>
<section id="finally-hello-world-in-assembly">
<h3><span class="section-number">14.5.2. </span>Finally “Hello World in Assembly”<a class="headerlink" href="#finally-hello-world-in-assembly" title="Permalink to this headline">#</a></h3>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<p><b>CODE: asm - hello.S</p>
<div style="width:107em; height:100%; font-size:inherit; overflow: auto;" >
<div class="highlight-gas notranslate"><div class="highlight"><pre><span></span><span class="w">	</span><span class="na">.intel_syntax</span><span class="w"> </span><span class="no">noprefix</span><span class="w"></span>
<span class="w">	</span><span class="na">.section</span><span class="w"> </span><span class="no">.rodata</span><span class="w"></span>
<span class="nl">str:</span><span class="w"></span>
<span class="w">	</span><span class="na">.string</span><span class="w"> </span><span class="s">&quot;Hello World\n&quot;</span><span class="w"></span>

<span class="w">	</span><span class="na">.section</span><span class="w"> </span><span class="no">.text</span><span class="w"></span>
<span class="w">	</span><span class="na">.global</span><span class="w"> </span><span class="no">_start</span><span class="w"></span>
<span class="nl">_start:</span><span class="w"></span>
<span class="w">	</span><span class="nf">mov</span><span class="w"> </span><span class="no">rax</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">	</span><span class="nf">mov</span><span class="w"> </span><span class="no">rdi</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">	</span><span class="nf">mov</span><span class="w"> </span><span class="no">rsi</span><span class="p">,</span><span class="w"> </span><span class="no">OFFSET</span><span class="w"> </span><span class="no">str</span><span class="w"></span>
<span class="w">	</span><span class="nf">mov</span><span class="w"> </span><span class="no">rdx</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="w"></span>
<span class="w">	</span><span class="nf">syscall</span><span class="w"></span>

<span class="w">	</span><span class="nf">mov</span><span class="w"> </span><span class="no">rax</span><span class="p">,</span><span class="w"> </span><span class="mi">60</span><span class="w"></span>
<span class="w">	</span><span class="nf">mov</span><span class="w"> </span><span class="no">rdi</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="w">	</span><span class="nf">syscall</span><span class="w"></span>
<span class="w">	</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "c03241329e3a40649029caa05b36324b", "version_major": 2, "version_minor": 0}
</script></div>
</div>
<section id="at-long-last-we-have-a-program-that-we-don-t-need-the-debugger-for">
<h4><span class="section-number">14.5.2.1. </span>At long last we have a program that we don’t need the debugger for!<a class="headerlink" href="#at-long-last-we-have-a-program-that-we-don-t-need-the-debugger-for" title="Permalink to this headline">#</a></h4>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "89f776625e6a4fe7b91af1e31d125bc0", "version_major": 2, "version_minor": 0}
</script></div>
</div>
</section>
</section>
<section id="there-are-many-more-calls-for-doing-i-o">
<h3><span class="section-number">14.5.3. </span>There are many more calls for doing I/O<a class="headerlink" href="#there-are-many-more-calls-for-doing-i-o" title="Permalink to this headline">#</a></h3>
<p>But we can now</p>
<ol class="simple">
<li><p>transfer bytes from our address space to a “file” - write system call</p></li>
<li><p>transfer bytes from a “file” to our address space  - read system call</p></li>
<li><p>connect (and possibly create) files to our address space for reading and writing - open system call</p></li>
<li><p>disconnect a file from our address space - close system call</p></li>
</ol>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html">
<iframe
    width="100%"
    height="600"
    src="https://filippo.io/linux-syscall-table/"
    frameborder="0"
    allowfullscreen

></iframe>
</div></div>
</div>
</section>
<section id="exercises">
<h3><span class="section-number">14.5.4. </span>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">#</a></h3>
<p>Change the <code class="docutils literal notranslate"><span class="pre">usesum</span></code> program to:</p>
<ul class="simple">
<li><p>exit properly</p></li>
<li><p>allocate memory for the data</p></li>
<li><p>read the data in from standard in</p></li>
<li><p>write the binary result to standard out</p>
<ul>
<li><p>use a shell command like <code class="docutils literal notranslate"><span class="pre">od</span> <span class="pre">-l</span> <span class="pre">-A10</span></code> to convert the output to ascii</p></li>
</ul>
</li>
<li><p>open the binary file of numbers and read them in</p></li>
<li><p>can you figure out how to get the command line arguments?</p></li>
<li><p>Write a new program that uses the random instruction to create a data file</p></li>
</ul>
</section>
</section>
</section>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"0046d9f05a654785afa777d63e549605": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_e2870ad770ce40fc9a092feb18fd201e", "msg_id": "", "outputs": [{"name": "stdout", "output_type": "stream", "text": "$ man brk | head -37\nBRK(2)                     Linux Programmer's Manual                    BRK(2)\r\n\r\nNAME\r\n       brk, sbrk - change data segment size\r\n\r\nSYNOPSIS\r\n       #include <unistd.h>\r\n\r\n       int brk(void *addr);\r\n\r\n       void *sbrk(intptr_t increment);\r\n\r\n   Feature Test Macro Requirements for glibc (see feature_test_macros(7)):\r\n\r\n       brk(), sbrk():\r\n           Since glibc 2.19:\r\n               _DEFAULT_SOURCE ||\r\n                   (_XOPEN_SOURCE >= 500) &&\r\n                   ! (_POSIX_C_SOURCE >= 200112L)\r\n           From glibc 2.12 to 2.19:\r\n               _BSD_SOURCE || _SVID_SOURCE ||\r\n                   (_XOPEN_SOURCE >= 500) &&\r\n                   ! (_POSIX_C_SOURCE >= 200112L)\r\n           Before glibc 2.12:\r\n               _BSD_SOURCE || _SVID_SOURCE || _XOPEN_SOURCE >= 500\r\n\r\nDESCRIPTION\r\n       brk()  and  sbrk()  change the location of the program break, which de\u2010\r\n       fines the end of the process's data segment (i.e., the program break is\r\n       the  first  location  after the end of the uninitialized data segment).\r\n       Increasing the program break has the effect of allocating memory to the\r\n       process; decreasing the break deallocates memory.\r\n\r\n       brk()  sets the end of the data segment to the value specified by addr,\r\n       when that value is reasonable, the system has enough  memory,  and  the\r\n       process does not exceed its maximum data size (see setrlimit(2)).\r\n\r\n$ "}]}}, "1582296427f14e10aae06106fdb6acb0": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_805c9d01575543839ce54103824942c1", "msg_id": "", "outputs": [{"name": "stdout", "output_type": "stream", "text": "$ man syscalls | head -20\nSYSCALLS(2)                Linux Programmer's Manual               SYSCALLS(2)\r\n\r\nNAME\r\n       syscalls - Linux system calls\r\n\r\nSYNOPSIS\r\n       Linux system calls.\r\n\r\nDESCRIPTION\r\n       The system call is the fundamental interface between an application and\r\n       the Linux kernel.\r\n\r\n   System calls and library wrapper functions\r\n       System calls are generally not invoked directly, but rather via wrapper\r\n       functions in glibc (or perhaps some other library).  For details of di\u2010\r\n       rect invocation of a system call, see intro(2).  Often, but not always,\r\n       the  name of the wrapper function is the same as the name of the system\r\n       call that it invokes.  For example, glibc contains a  function  chdir()\r\n       which invokes the underlying \"chdir\" system call.\r\n\r\n$ "}]}}, "6cf69bd29d18472aad10193a881f7e4a": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": "1px solid black", "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "100%", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": "scroll", "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "796e616035d04bf0bd4a1f42d928f133": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_d04eb772761845419384fb82cc4e2238", "msg_id": "", "outputs": [{"name": "stdout", "output_type": "stream", "text": "$ man syscall | head -20\nSYSCALL(2)                 Linux Programmer's Manual                SYSCALL(2)\r\n\r\nNAME\r\n       syscall - indirect system call\r\n\r\nSYNOPSIS\r\n       #include <unistd.h>\r\n       #include <sys/syscall.h>   /* For SYS_xxx definitions */\r\n\r\n       long syscall(long number, ...);\r\n\r\n   Feature Test Macro Requirements for glibc (see feature_test_macros(7)):\r\n       syscall():\r\n           Since glibc 2.19:\r\n               _DEFAULT_SOURCE\r\n           Before glibc 2.19:\r\n               _BSD_SOURCE || _SVID_SOURCE\r\n\r\nDESCRIPTION\r\n       syscall()  is  a  small  library  function that invokes the system call\r\n$ "}]}}, "805c9d01575543839ce54103824942c1": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": "1px solid black", "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "100%", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": "scroll", "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "89f776625e6a4fe7b91af1e31d125bc0": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_f9bd376d8f5a4ff8a20ff6e63194113a", "msg_id": "", "outputs": [{"name": "stdout", "output_type": "stream", "text": "$ ./hello; echo $?\nHello World\r\n3\r\n$ "}]}}, "98902260508747ada0870d24b54cb67d": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": "1px solid black", "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "100%", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": "scroll", "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "9a7613c916184703846ecb991a66d0a8": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": "1px solid black", "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "100%", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": "scroll", "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a0bf796a34a4439cb4cef1a777640a45": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": "1px solid black", "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "100%", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": "scroll", "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c03241329e3a40649029caa05b36324b": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_a0bf796a34a4439cb4cef1a777640a45", "msg_id": "", "outputs": [{"name": "stdout", "output_type": "stream", "text": "\nas -g -a=hello.o.lst hello.s -o hello.o\r\nld -g -Map=hello.map hello.o -o hello\r\n"}]}}, "c7fbfe3f55f64e4a9e9161c977872d45": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": "1px solid black", "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "100%", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": "scroll", "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d04eb772761845419384fb82cc4e2238": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": "1px solid black", "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "100%", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": "scroll", "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "dd5e3c4bae194857a88d0206d43b7929": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_c7fbfe3f55f64e4a9e9161c977872d45", "msg_id": "", "outputs": [{"name": "stdout", "output_type": "stream", "text": "\nas -g -a=usesum5.o.lst usesum5.s -o usesum5.o\r\nas -g -a=sumit6.o.lst sumit6.s -o sumit6.o\r\nld -g -Map=usesum6.map usesum5.o sumit6.o -o usesum6\r\n"}]}}, "e2870ad770ce40fc9a092feb18fd201e": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": "1px solid black", "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "100%", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": "scroll", "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e5a2de6ee9d54e5d9f487acc2f174706": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_98902260508747ada0870d24b54cb67d", "msg_id": "", "outputs": [{"name": "stdout", "output_type": "stream", "text": "$ man proc | head -30\nPROC(5)                    Linux Programmer's Manual                   PROC(5)\r\n\r\nNAME\r\n       proc - process information pseudo-filesystem\r\n\r\nDESCRIPTION\r\n       The  proc filesystem is a pseudo-filesystem which provides an interface\r\n       to kernel data structures.  It is commonly  mounted  at  /proc.   Typi\u2010\r\n       cally,  it  is  mounted automatically by the system, but it can also be\r\n       mounted manually using a command such as:\r\n\r\n           mount -t proc proc /proc\r\n\r\n       Most of the files in the proc filesystem are read-only, but some  files\r\n       are writable, allowing kernel variables to be changed.\r\n\r\n   Mount options\r\n       The proc filesystem supports the following mount options:\r\n\r\n       hidepid=n (since Linux 3.3)\r\n              This   option   controls  who  can  access  the  information  in\r\n              /proc/[pid] directories.  The argument, n, is one of the follow\u2010\r\n              ing values:\r\n\r\n              0   Everybody  may  access all /proc/[pid] directories.  This is\r\n                  the traditional behavior, and the default if this mount  op\u2010\r\n                  tion is not specified.\r\n\r\n              1   Users  may  not  access  files and subdirectories inside any\r\n                  /proc/[pid] directories but their own (the  /proc/[pid]  di\u2010\r\n$ "}]}}, "ecc478b04bfb4400b8683f8276f0bc91": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_6cf69bd29d18472aad10193a881f7e4a", "msg_id": "", "outputs": [{"name": "stdout", "output_type": "stream", "text": "$ man proc | grep -A40 /maps | head -41\n       /proc/[pid]/maps\r\n              A  file containing the currently mapped memory regions and their\r\n              access permissions.  See mmap(2) for  some  further  information\r\n              about memory mappings.\r\n\r\n              Permission  to  access  this file is governed by a ptrace access\r\n              mode PTRACE_MODE_READ_FSCREDS check; see ptrace(2).\r\n\r\n              The format of the file is:\r\n\r\n    address           perms offset  dev   inode       pathname\r\n    00400000-00452000 r-xp 00000000 08:02 173521      /usr/bin/dbus-daemon\r\n    00651000-00652000 r--p 00051000 08:02 173521      /usr/bin/dbus-daemon\r\n    00652000-00655000 rw-p 00052000 08:02 173521      /usr/bin/dbus-daemon\r\n    00e03000-00e24000 rw-p 00000000 00:00 0           [heap]\r\n    00e24000-011f7000 rw-p 00000000 00:00 0           [heap]\r\n    ...\r\n    35b1800000-35b1820000 r-xp 00000000 08:02 135522  /usr/lib64/ld-2.15.so\r\n    35b1a1f000-35b1a20000 r--p 0001f000 08:02 135522  /usr/lib64/ld-2.15.so\r\n    35b1a20000-35b1a21000 rw-p 00020000 08:02 135522  /usr/lib64/ld-2.15.so\r\n    35b1a21000-35b1a22000 rw-p 00000000 00:00 0\r\n    35b1c00000-35b1dac000 r-xp 00000000 08:02 135870  /usr/lib64/libc-2.15.so\r\n    35b1dac000-35b1fac000 ---p 001ac000 08:02 135870  /usr/lib64/libc-2.15.so\r\n    35b1fac000-35b1fb0000 r--p 001ac000 08:02 135870  /usr/lib64/libc-2.15.so\r\n    35b1fb0000-35b1fb2000 rw-p 001b0000 08:02 135870  /usr/lib64/libc-2.15.so\r\n    ...\r\n    f2c6ff8c000-7f2c7078c000 rw-p 00000000 00:00 0    [stack:986]\r\n    ...\r\n    7fffb2c0d000-7fffb2c2e000 rw-p 00000000 00:00 0   [stack]\r\n    7fffb2d48000-7fffb2d49000 r-xp 00000000 00:00 0   [vdso]\r\n\r\n              The address field is the address space in the process  that  the\r\n              mapping occupies.  The perms field is a set of permissions:\r\n\r\n                  r = read\r\n                  w = write\r\n                  x = execute\r\n                  s = shared\r\n                  p = private (copy on write)\r\n\r\n              The  offset  field  is the offset into the file/whatever; dev is\r\n$ "}]}}, "ee7250f240274126b3cf6af2683fbe54": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_9a7613c916184703846ecb991a66d0a8", "msg_id": "", "outputs": [{"name": "stdout", "output_type": "stream", "text": "$ ls /home/jovyan/syscalls\n100.nums  hello.s   setup.gdb  usesum5.s\r\nbrk.s     Makefile  sumit6.s   usesumheap.s\r\n$ "}]}}, "f9bd376d8f5a4ff8a20ff6e63194113a": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": "1px solid black", "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "100%", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": "scroll", "padding": null, "right": null, "top": null, "visibility": null, "width": null}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./assembly"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="L13.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">13. </span>SLS Lecture 13 : Program Anatomy V: The Tree of Bytes and Data Structures</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="L15.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">15. </span>SLS Lecture 15 : Processes and Virtual Memory</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Jonathan Appavoo<br/>
  
      &copy; Copyright 2021.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>